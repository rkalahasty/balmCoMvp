{"ast":null,"code":"\"use strict\";\n\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nconst MessageEvent = require(\"./generated/MessageEvent\");\n\nconst idlUtils = require(\"./generated/utils\");\n\nconst {\n  isValidTargetOrigin\n} = require(\"../utils\");\n\nconst {\n  fireAnEvent\n} = require(\"./helpers/events\");\n\nmodule.exports = function (globalObject) {\n  return function (message, targetOrigin) {\n    if (arguments.length < 2) {\n      throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n    }\n\n    targetOrigin = String(targetOrigin);\n\n    if (!isValidTargetOrigin(targetOrigin)) {\n      // TODO: Fix me\n      throw DOMException.create(globalObject, [\"Failed to execute 'postMessage' on 'Window': \" + \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\", \"SyntaxError\"]);\n    } // TODO: targetOrigin === '/' - requires reference to source window\n    // See https://github.com/jsdom/jsdom/pull/1140#issuecomment-111587499\n\n\n    if (targetOrigin !== \"*\" && targetOrigin !== idlUtils.implForWrapper(globalObject._document)._origin) {\n      return;\n    } // TODO: event.source - requires reference to source window\n    // TODO: event.origin - requires reference to source window\n    // TODO: event.ports\n    // TODO: event.data - structured clone message - requires cloning DOM nodes\n\n\n    setTimeout(() => {\n      fireAnEvent(\"message\", this, MessageEvent, {\n        data: message\n      });\n    }, 0);\n  };\n};","map":{"version":3,"names":["DOMException","require","MessageEvent","idlUtils","isValidTargetOrigin","fireAnEvent","module","exports","globalObject","message","targetOrigin","arguments","length","TypeError","String","create","implForWrapper","_document","_origin","setTimeout","data"],"sources":["C:/Users/17033/balmco/node_modules/jsdom/lib/jsdom/living/post-message.js"],"sourcesContent":["\"use strict\";\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\nconst MessageEvent = require(\"./generated/MessageEvent\");\nconst idlUtils = require(\"./generated/utils\");\nconst { isValidTargetOrigin } = require(\"../utils\");\nconst { fireAnEvent } = require(\"./helpers/events\");\n\nmodule.exports = function (globalObject) {\n  return function (message, targetOrigin) {\n    if (arguments.length < 2) {\n      throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n    }\n\n    targetOrigin = String(targetOrigin);\n\n    if (!isValidTargetOrigin(targetOrigin)) {\n      // TODO: Fix me\n      throw DOMException.create(globalObject, [\n        \"Failed to execute 'postMessage' on 'Window': \" +\n        \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\",\n        \"SyntaxError\"\n      ]);\n    }\n\n    // TODO: targetOrigin === '/' - requires reference to source window\n    // See https://github.com/jsdom/jsdom/pull/1140#issuecomment-111587499\n    if (targetOrigin !== \"*\" && targetOrigin !== idlUtils.implForWrapper(globalObject._document)._origin) {\n      return;\n    }\n\n    // TODO: event.source - requires reference to source window\n    // TODO: event.origin - requires reference to source window\n    // TODO: event.ports\n    // TODO: event.data - structured clone message - requires cloning DOM nodes\n    setTimeout(() => {\n      fireAnEvent(\"message\", this, MessageEvent, { data: message });\n    }, 0);\n  };\n};\n"],"mappings":"AAAA;;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,gCAAD,CAA5B;;AACA,MAAMC,YAAY,GAAGD,OAAO,CAAC,0BAAD,CAA5B;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAxB;;AACA,MAAM;EAAEG;AAAF,IAA0BH,OAAO,CAAC,UAAD,CAAvC;;AACA,MAAM;EAAEI;AAAF,IAAkBJ,OAAO,CAAC,kBAAD,CAA/B;;AAEAK,MAAM,CAACC,OAAP,GAAiB,UAAUC,YAAV,EAAwB;EACvC,OAAO,UAAUC,OAAV,EAAmBC,YAAnB,EAAiC;IACtC,IAAIC,SAAS,CAACC,MAAV,GAAmB,CAAvB,EAA0B;MACxB,MAAM,IAAIC,SAAJ,CAAc,kEAAd,CAAN;IACD;;IAEDH,YAAY,GAAGI,MAAM,CAACJ,YAAD,CAArB;;IAEA,IAAI,CAACN,mBAAmB,CAACM,YAAD,CAAxB,EAAwC;MACtC;MACA,MAAMV,YAAY,CAACe,MAAb,CAAoBP,YAApB,EAAkC,CACtC,kDACA,yBADA,GAC4BE,YAD5B,GAC2C,+BAFL,EAGtC,aAHsC,CAAlC,CAAN;IAKD,CAdqC,CAgBtC;IACA;;;IACA,IAAIA,YAAY,KAAK,GAAjB,IAAwBA,YAAY,KAAKP,QAAQ,CAACa,cAAT,CAAwBR,YAAY,CAACS,SAArC,EAAgDC,OAA7F,EAAsG;MACpG;IACD,CApBqC,CAsBtC;IACA;IACA;IACA;;;IACAC,UAAU,CAAC,MAAM;MACfd,WAAW,CAAC,SAAD,EAAY,IAAZ,EAAkBH,YAAlB,EAAgC;QAAEkB,IAAI,EAAEX;MAAR,CAAhC,CAAX;IACD,CAFS,EAEP,CAFO,CAAV;EAGD,CA7BD;AA8BD,CA/BD"},"metadata":{},"sourceType":"script"}