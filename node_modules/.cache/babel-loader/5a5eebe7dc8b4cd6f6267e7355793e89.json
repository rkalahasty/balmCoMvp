{"ast":null,"code":"\"use strict\";\n\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nconst NODE_TYPE = require(\"../node-type\");\n\nconst {\n  nodeLength,\n  nodeRoot\n} = require(\"../helpers/node\");\n\nconst {\n  domSymbolTree\n} = require(\"../helpers/internal-constants\");\n\nconst {\n  compareBoundaryPointsPosition\n} = require(\"../range/boundary-point\");\n\nconst {\n  setBoundaryPointStart,\n  setBoundaryPointEnd\n} = require(\"../range/Range-impl\");\n\nconst Range = require(\"../generated/Range\");\n\nconst {\n  implForWrapper\n} = require(\"../generated/utils\"); // https://w3c.github.io/selection-api/#dfn-direction\n\n\nconst SELECTION_DIRECTION = {\n  FORWARDS: 1,\n  BACKWARDS: -1,\n  DIRECTIONLESS: 0\n}; // https://w3c.github.io/selection-api/#dom-selection\n\nclass SelectionImpl {\n  constructor(globalObject) {\n    this._range = null;\n    this._direction = SELECTION_DIRECTION.DIRECTIONLESS;\n    this._globalObject = globalObject;\n  } // https://w3c.github.io/selection-api/#dom-selection-anchornode\n\n\n  get anchorNode() {\n    const anchor = this._anchor;\n    return anchor ? anchor.node : null;\n  } // https://w3c.github.io/selection-api/#dom-selection-anchoroffset\n\n\n  get anchorOffset() {\n    const anchor = this._anchor;\n    return anchor ? anchor.offset : 0;\n  } // https://w3c.github.io/selection-api/#dom-selection-focusnode\n\n\n  get focusNode() {\n    const focus = this._focus;\n    return focus ? focus.node : null;\n  } // https://w3c.github.io/selection-api/#dom-selection-focusoffset\n\n\n  get focusOffset() {\n    const focus = this._focus;\n    return focus ? focus.offset : 0;\n  } // https://w3c.github.io/selection-api/#dom-selection-iscollapsed\n\n\n  get isCollapsed() {\n    return this._range === null || this._range.collapsed;\n  } // https://w3c.github.io/selection-api/#dom-selection-rangecount\n\n\n  get rangeCount() {\n    return this._isEmpty() ? 0 : 1;\n  } // https://w3c.github.io/selection-api/#dom-selection-type\n\n\n  get type() {\n    if (this._isEmpty()) {\n      return \"None\";\n    } else if (this._range.collapsed) {\n      return \"Caret\";\n    }\n\n    return \"Range\";\n  } // https://w3c.github.io/selection-api/#dom-selection-getrangeat\n\n\n  getRangeAt(index) {\n    if (index !== 0 || this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    return this._range;\n  } // https://w3c.github.io/selection-api/#dom-selection-addrange\n\n\n  addRange(range) {\n    if (range._root === implForWrapper(this._globalObject._document) && this.rangeCount === 0) {\n      this._associateRange(range);\n    }\n  } // https://w3c.github.io/selection-api/#dom-selection-removerange\n\n\n  removeRange(range) {\n    if (range !== this._range) {\n      throw DOMException.create(this._globalObject, [\"Invalid range.\", \"NotFoundError\"]);\n    }\n\n    this._associateRange(null);\n  } // https://w3c.github.io/selection-api/#dom-selection-removeallranges\n\n\n  removeAllRanges() {\n    this._associateRange(null);\n  } // https://w3c.github.io/selection-api/#dom-selection-empty\n\n\n  empty() {\n    this.removeAllRanges();\n  } // https://w3c.github.io/selection-api/#dom-selection-collapse\n\n\n  collapse(node, offset) {\n    if (node === null) {\n      this.removeAllRanges();\n      return;\n    }\n\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\"DocumentType Node can't be used as boundary point.\", \"InvalidNodeTypeError\"]);\n    }\n\n    if (offset > nodeLength(node)) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: {\n        node,\n        offset: 0\n      },\n      end: {\n        node,\n        offset: 0\n      }\n    });\n    setBoundaryPointStart(newRange, node, offset);\n    setBoundaryPointEnd(newRange, node, offset);\n\n    this._associateRange(newRange);\n  } // https://w3c.github.io/selection-api/#dom-selection-setposition\n\n\n  setPosition(node, offset) {\n    this.collapse(node, offset);\n  } // https://w3c.github.io/selection-api/#dom-selection-collapsetostart\n\n\n  collapseToStart() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const {\n      node,\n      offset\n    } = this._range._start;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: {\n        node,\n        offset\n      },\n      end: {\n        node,\n        offset\n      }\n    });\n\n    this._associateRange(newRange);\n  } // https://w3c.github.io/selection-api/#dom-selection-collapsetoend\n\n\n  collapseToEnd() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const {\n      node,\n      offset\n    } = this._range._end;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: {\n        node,\n        offset\n      },\n      end: {\n        node,\n        offset\n      }\n    });\n\n    this._associateRange(newRange);\n  } // https://w3c.github.io/selection-api/#dom-selection-extend\n\n\n  extend(node, offset) {\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to extend.\", \"InvalidStateError\"]);\n    }\n\n    const {\n      _anchor: oldAnchor\n    } = this;\n    const newFocus = {\n      node,\n      offset\n    };\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: {\n        node,\n        offset: 0\n      },\n      end: {\n        node,\n        offset: 0\n      }\n    });\n\n    if (nodeRoot(node) !== this._range._root) {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else if (compareBoundaryPointsPosition(oldAnchor, newFocus) <= 0) {\n      setBoundaryPointStart(newRange, oldAnchor.node, oldAnchor.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, oldAnchor.node, oldAnchor.offset);\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(newFocus, oldAnchor) === -1 ? SELECTION_DIRECTION.BACKWARDS : SELECTION_DIRECTION.FORWARDS;\n  } // https://w3c.github.io/selection-api/#dom-selection-setbaseandextent\n\n\n  setBaseAndExtent(anchorNode, anchorOffset, focusNode, focusOffset) {\n    if (anchorOffset > nodeLength(anchorNode) || focusOffset > nodeLength(focusNode)) {\n      throw DOMException.create(this._globalObject, [\"Invalid anchor or focus offset.\", \"IndexSizeError\"]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n\n    if (document !== nodeRoot(anchorNode) || document !== nodeRoot(focusNode)) {\n      return;\n    }\n\n    const anchor = {\n      node: anchorNode,\n      offset: anchorOffset\n    };\n    const focus = {\n      node: focusNode,\n      offset: focusOffset\n    };\n    let newRange;\n\n    if (compareBoundaryPointsPosition(anchor, focus) === -1) {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: anchor.node,\n          offset: anchor.offset\n        },\n        end: {\n          node: focus.node,\n          offset: focus.offset\n        }\n      });\n    } else {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: {\n          node: focus.node,\n          offset: focus.offset\n        },\n        end: {\n          node: anchor.node,\n          offset: anchor.offset\n        }\n      });\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(focus, anchor) === -1 ? SELECTION_DIRECTION.BACKWARDS : SELECTION_DIRECTION.FORWARDS;\n  } // https://w3c.github.io/selection-api/#dom-selection-selectallchildren\n\n\n  selectAllChildren(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\"DocumentType Node can't be used as boundary point.\", \"InvalidNodeTypeError\"]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n\n    if (document !== nodeRoot(node)) {\n      return;\n    }\n\n    const length = domSymbolTree.childrenCount(node);\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: {\n        node,\n        offset: 0\n      },\n      end: {\n        node,\n        offset: 0\n      }\n    });\n    setBoundaryPointStart(newRange, node, 0);\n    setBoundaryPointEnd(newRange, node, length);\n\n    this._associateRange(newRange);\n  } // https://w3c.github.io/selection-api/#dom-selection-deletefromdocument\n\n\n  deleteFromDocument() {\n    if (!this._isEmpty()) {\n      this._range.deleteContents();\n    }\n  } // https://w3c.github.io/selection-api/#dom-selection-containsnode\n\n\n  containsNode(node, allowPartialContainment) {\n    if (this._isEmpty() || nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return false;\n    }\n\n    const {\n      _start,\n      _end\n    } = this._range;\n    const startIsBeforeNode = compareBoundaryPointsPosition(_start, {\n      node,\n      offset: 0\n    }) === -1;\n    const endIsAfterNode = compareBoundaryPointsPosition(_end, {\n      node,\n      offset: nodeLength(node)\n    }) === 1;\n    return allowPartialContainment ? startIsBeforeNode || endIsAfterNode : startIsBeforeNode && endIsAfterNode;\n  } // https://w3c.github.io/selection-api/#dom-selection-stringifier\n\n\n  toString() {\n    return this._range ? this._range.toString() : \"\";\n  } // https://w3c.github.io/selection-api/#dfn-empty\n\n\n  _isEmpty() {\n    return this._range === null;\n  } // https://w3c.github.io/selection-api/#dfn-anchor\n\n\n  get _anchor() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ? this._range._start : this._range._end;\n  } // https://w3c.github.io/selection-api/#dfn-focus\n\n\n  get _focus() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ? this._range._end : this._range._start;\n  }\n\n  _associateRange(newRange) {\n    this._range = newRange;\n    this._direction = newRange === null ? SELECTION_DIRECTION.DIRECTIONLESS : SELECTION_DIRECTION.FORWARDS; // TODO: Emit \"selectionchange\" event. At this time, there is currently no test in WPT covering this.\n    // https://w3c.github.io/selection-api/#selectionchange-event\n  }\n\n}\n\nmodule.exports = {\n  implementation: SelectionImpl\n};","map":{"version":3,"names":["DOMException","require","NODE_TYPE","nodeLength","nodeRoot","domSymbolTree","compareBoundaryPointsPosition","setBoundaryPointStart","setBoundaryPointEnd","Range","implForWrapper","SELECTION_DIRECTION","FORWARDS","BACKWARDS","DIRECTIONLESS","SelectionImpl","constructor","globalObject","_range","_direction","_globalObject","anchorNode","anchor","_anchor","node","anchorOffset","offset","focusNode","focus","_focus","focusOffset","isCollapsed","collapsed","rangeCount","_isEmpty","type","getRangeAt","index","create","addRange","range","_root","_document","_associateRange","removeRange","removeAllRanges","empty","collapse","nodeType","DOCUMENT_TYPE_NODE","newRange","createImpl","start","end","setPosition","collapseToStart","_start","collapseToEnd","_end","extend","oldAnchor","newFocus","setBaseAndExtent","document","selectAllChildren","length","childrenCount","deleteFromDocument","deleteContents","containsNode","allowPartialContainment","startIsBeforeNode","endIsAfterNode","toString","module","exports","implementation"],"sources":["C:/Users/17033/balmco/node_modules/jsdom/lib/jsdom/living/selection/Selection-impl.js"],"sourcesContent":["\"use strict\";\n\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nconst NODE_TYPE = require(\"../node-type\");\nconst { nodeLength, nodeRoot } = require(\"../helpers/node\");\nconst { domSymbolTree } = require(\"../helpers/internal-constants\");\nconst { compareBoundaryPointsPosition } = require(\"../range/boundary-point\");\n\nconst { setBoundaryPointStart, setBoundaryPointEnd } = require(\"../range/Range-impl\");\n\nconst Range = require(\"../generated/Range\");\nconst { implForWrapper } = require(\"../generated/utils\");\n\n// https://w3c.github.io/selection-api/#dfn-direction\nconst SELECTION_DIRECTION = {\n  FORWARDS: 1,\n  BACKWARDS: -1,\n  DIRECTIONLESS: 0\n};\n\n// https://w3c.github.io/selection-api/#dom-selection\nclass SelectionImpl {\n  constructor(globalObject) {\n    this._range = null;\n    this._direction = SELECTION_DIRECTION.DIRECTIONLESS;\n\n    this._globalObject = globalObject;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-anchornode\n  get anchorNode() {\n    const anchor = this._anchor;\n    return anchor ? anchor.node : null;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-anchoroffset\n  get anchorOffset() {\n    const anchor = this._anchor;\n    return anchor ? anchor.offset : 0;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-focusnode\n  get focusNode() {\n    const focus = this._focus;\n    return focus ? focus.node : null;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-focusoffset\n  get focusOffset() {\n    const focus = this._focus;\n    return focus ? focus.offset : 0;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-iscollapsed\n  get isCollapsed() {\n    return this._range === null || this._range.collapsed;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-rangecount\n  get rangeCount() {\n    return this._isEmpty() ? 0 : 1;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-type\n  get type() {\n    if (this._isEmpty()) {\n      return \"None\";\n    } else if (this._range.collapsed) {\n      return \"Caret\";\n    }\n\n    return \"Range\";\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-getrangeat\n  getRangeAt(index) {\n    if (index !== 0 || this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    return this._range;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-addrange\n  addRange(range) {\n    if (range._root === implForWrapper(this._globalObject._document) && this.rangeCount === 0) {\n      this._associateRange(range);\n    }\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-removerange\n  removeRange(range) {\n    if (range !== this._range) {\n      throw DOMException.create(this._globalObject, [\"Invalid range.\", \"NotFoundError\"]);\n    }\n\n    this._associateRange(null);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-removeallranges\n  removeAllRanges() {\n    this._associateRange(null);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-empty\n  empty() {\n    this.removeAllRanges();\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapse\n  collapse(node, offset) {\n    if (node === null) {\n      this.removeAllRanges();\n      return;\n    }\n\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\n        \"DocumentType Node can't be used as boundary point.\",\n        \"InvalidNodeTypeError\"\n      ]);\n    }\n\n    if (offset > nodeLength(node)) {\n      throw DOMException.create(this._globalObject, [\"Invalid range index.\", \"IndexSizeError\"]);\n    }\n\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    setBoundaryPointStart(newRange, node, offset);\n    setBoundaryPointEnd(newRange, node, offset);\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-setposition\n  setPosition(node, offset) {\n    this.collapse(node, offset);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapsetostart\n  collapseToStart() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const { node, offset } = this._range._start;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset },\n      end: { node, offset }\n    });\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-collapsetoend\n  collapseToEnd() {\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to collapse.\", \"InvalidStateError\"]);\n    }\n\n    const { node, offset } = this._range._end;\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset },\n      end: { node, offset }\n    });\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-extend\n  extend(node, offset) {\n    if (nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return;\n    }\n\n    if (this._isEmpty()) {\n      throw DOMException.create(this._globalObject, [\"There is no selection to extend.\", \"InvalidStateError\"]);\n    }\n\n    const { _anchor: oldAnchor } = this;\n    const newFocus = { node, offset };\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    if (nodeRoot(node) !== this._range._root) {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else if (compareBoundaryPointsPosition(oldAnchor, newFocus) <= 0) {\n      setBoundaryPointStart(newRange, oldAnchor.node, oldAnchor.offset);\n      setBoundaryPointEnd(newRange, newFocus.node, newFocus.offset);\n    } else {\n      setBoundaryPointStart(newRange, newFocus.node, newFocus.offset);\n      setBoundaryPointEnd(newRange, oldAnchor.node, oldAnchor.offset);\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(newFocus, oldAnchor) === -1 ?\n      SELECTION_DIRECTION.BACKWARDS :\n      SELECTION_DIRECTION.FORWARDS;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-setbaseandextent\n  setBaseAndExtent(anchorNode, anchorOffset, focusNode, focusOffset) {\n    if (anchorOffset > nodeLength(anchorNode) || focusOffset > nodeLength(focusNode)) {\n      throw DOMException.create(this._globalObject, [\"Invalid anchor or focus offset.\", \"IndexSizeError\"]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n    if (document !== nodeRoot(anchorNode) || document !== nodeRoot(focusNode)) {\n      return;\n    }\n\n    const anchor = { node: anchorNode, offset: anchorOffset };\n    const focus = { node: focusNode, offset: focusOffset };\n\n    let newRange;\n    if (compareBoundaryPointsPosition(anchor, focus) === -1) {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: { node: anchor.node, offset: anchor.offset },\n        end: { node: focus.node, offset: focus.offset }\n      });\n    } else {\n      newRange = Range.createImpl(this._globalObject, [], {\n        start: { node: focus.node, offset: focus.offset },\n        end: { node: anchor.node, offset: anchor.offset }\n      });\n    }\n\n    this._associateRange(newRange);\n\n    this._direction = compareBoundaryPointsPosition(focus, anchor) === -1 ?\n      SELECTION_DIRECTION.BACKWARDS :\n      SELECTION_DIRECTION.FORWARDS;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-selectallchildren\n  selectAllChildren(node) {\n    if (node.nodeType === NODE_TYPE.DOCUMENT_TYPE_NODE) {\n      throw DOMException.create(this._globalObject, [\n        \"DocumentType Node can't be used as boundary point.\",\n        \"InvalidNodeTypeError\"\n      ]);\n    }\n\n    const document = implForWrapper(this._globalObject._document);\n    if (document !== nodeRoot(node)) {\n      return;\n    }\n\n    const length = domSymbolTree.childrenCount(node);\n\n    const newRange = Range.createImpl(this._globalObject, [], {\n      start: { node, offset: 0 },\n      end: { node, offset: 0 }\n    });\n\n    setBoundaryPointStart(newRange, node, 0);\n    setBoundaryPointEnd(newRange, node, length);\n\n    this._associateRange(newRange);\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-deletefromdocument\n  deleteFromDocument() {\n    if (!this._isEmpty()) {\n      this._range.deleteContents();\n    }\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-containsnode\n  containsNode(node, allowPartialContainment) {\n    if (this._isEmpty() || nodeRoot(node) !== implForWrapper(this._globalObject._document)) {\n      return false;\n    }\n\n    const { _start, _end } = this._range;\n\n    const startIsBeforeNode = compareBoundaryPointsPosition(_start, { node, offset: 0 }) === -1;\n    const endIsAfterNode = compareBoundaryPointsPosition(_end, { node, offset: nodeLength(node) }) === 1;\n\n    return allowPartialContainment ?\n      startIsBeforeNode || endIsAfterNode :\n      startIsBeforeNode && endIsAfterNode;\n  }\n\n  // https://w3c.github.io/selection-api/#dom-selection-stringifier\n  toString() {\n    return this._range ? this._range.toString() : \"\";\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-empty\n  _isEmpty() {\n    return this._range === null;\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-anchor\n  get _anchor() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ?\n      this._range._start :\n      this._range._end;\n  }\n\n  // https://w3c.github.io/selection-api/#dfn-focus\n  get _focus() {\n    if (!this._range) {\n      return null;\n    }\n\n    return this._direction === SELECTION_DIRECTION.FORWARDS ?\n      this._range._end :\n      this._range._start;\n  }\n\n  _associateRange(newRange) {\n    this._range = newRange;\n    this._direction = newRange === null ? SELECTION_DIRECTION.DIRECTIONLESS : SELECTION_DIRECTION.FORWARDS;\n\n    // TODO: Emit \"selectionchange\" event. At this time, there is currently no test in WPT covering this.\n    // https://w3c.github.io/selection-api/#selectionchange-event\n  }\n}\n\nmodule.exports = {\n  implementation: SelectionImpl\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}