{"ast":null,"code":"\"use strict\";\n\nclass QueueItem {\n  constructor(onLoad, onError, dependentItem) {\n    this.onLoad = onLoad;\n    this.onError = onError;\n    this.data = null;\n    this.error = null;\n    this.dependentItem = dependentItem;\n  }\n\n}\n/**\n * AsyncResourceQueue is the queue in charge of run the async scripts\n * and notify when they finish.\n */\n\n\nmodule.exports = class AsyncResourceQueue {\n  constructor() {\n    this.items = new Set();\n    this.dependentItems = new Set();\n  }\n\n  count() {\n    return this.items.size + this.dependentItems.size;\n  }\n\n  _notify() {\n    if (this._listener) {\n      this._listener();\n    }\n  }\n\n  _check(item) {\n    let promise;\n\n    if (item.onError && item.error) {\n      promise = item.onError(item.error);\n    } else if (item.onLoad && item.data) {\n      promise = item.onLoad(item.data);\n    }\n\n    promise.then(() => {\n      this.items.delete(item);\n      this.dependentItems.delete(item);\n\n      if (this.count() === 0) {\n        this._notify();\n      }\n    });\n  }\n\n  setListener(listener) {\n    this._listener = listener;\n  }\n\n  push(request, onLoad, onError, dependentItem) {\n    const q = this;\n    const item = new QueueItem(onLoad, onError, dependentItem);\n    q.items.add(item);\n    return request.then(data => {\n      item.data = data;\n\n      if (dependentItem && !dependentItem.finished) {\n        q.dependentItems.add(item);\n        return q.items.delete(item);\n      }\n\n      if (onLoad) {\n        return q._check(item);\n      }\n\n      q.items.delete(item);\n\n      if (q.count() === 0) {\n        q._notify();\n      }\n\n      return null;\n    }).catch(err => {\n      item.error = err;\n\n      if (dependentItem && !dependentItem.finished) {\n        q.dependentItems.add(item);\n        return q.items.delete(item);\n      }\n\n      if (onError) {\n        return q._check(item);\n      }\n\n      q.items.delete(item);\n\n      if (q.count() === 0) {\n        q._notify();\n      }\n\n      return null;\n    });\n  }\n\n  notifyItem(syncItem) {\n    for (const item of this.dependentItems) {\n      if (item.dependentItem === syncItem) {\n        this._check(item);\n      }\n    }\n  }\n\n};","map":{"version":3,"names":["QueueItem","constructor","onLoad","onError","dependentItem","data","error","module","exports","AsyncResourceQueue","items","Set","dependentItems","count","size","_notify","_listener","_check","item","promise","then","delete","setListener","listener","push","request","q","add","finished","catch","err","notifyItem","syncItem"],"sources":["C:/Users/17033/balmco/node_modules/jsdom/lib/jsdom/browser/resources/async-resource-queue.js"],"sourcesContent":["\"use strict\";\n\nclass QueueItem {\n  constructor(onLoad, onError, dependentItem) {\n    this.onLoad = onLoad;\n    this.onError = onError;\n    this.data = null;\n    this.error = null;\n    this.dependentItem = dependentItem;\n  }\n}\n\n/**\n * AsyncResourceQueue is the queue in charge of run the async scripts\n * and notify when they finish.\n */\nmodule.exports = class AsyncResourceQueue {\n  constructor() {\n    this.items = new Set();\n    this.dependentItems = new Set();\n  }\n\n  count() {\n    return this.items.size + this.dependentItems.size;\n  }\n\n  _notify() {\n    if (this._listener) {\n      this._listener();\n    }\n  }\n\n  _check(item) {\n    let promise;\n\n    if (item.onError && item.error) {\n      promise = item.onError(item.error);\n    } else if (item.onLoad && item.data) {\n      promise = item.onLoad(item.data);\n    }\n\n    promise\n      .then(() => {\n        this.items.delete(item);\n        this.dependentItems.delete(item);\n\n        if (this.count() === 0) {\n          this._notify();\n        }\n      });\n  }\n\n  setListener(listener) {\n    this._listener = listener;\n  }\n\n  push(request, onLoad, onError, dependentItem) {\n    const q = this;\n\n    const item = new QueueItem(onLoad, onError, dependentItem);\n\n    q.items.add(item);\n\n    return request\n      .then(data => {\n        item.data = data;\n\n        if (dependentItem && !dependentItem.finished) {\n          q.dependentItems.add(item);\n          return q.items.delete(item);\n        }\n\n        if (onLoad) {\n          return q._check(item);\n        }\n\n        q.items.delete(item);\n\n        if (q.count() === 0) {\n          q._notify();\n        }\n\n        return null;\n      })\n      .catch(err => {\n        item.error = err;\n\n        if (dependentItem && !dependentItem.finished) {\n          q.dependentItems.add(item);\n          return q.items.delete(item);\n        }\n\n        if (onError) {\n          return q._check(item);\n        }\n\n        q.items.delete(item);\n\n        if (q.count() === 0) {\n          q._notify();\n        }\n\n        return null;\n      });\n  }\n\n  notifyItem(syncItem) {\n    for (const item of this.dependentItems) {\n      if (item.dependentItem === syncItem) {\n        this._check(item);\n      }\n    }\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}