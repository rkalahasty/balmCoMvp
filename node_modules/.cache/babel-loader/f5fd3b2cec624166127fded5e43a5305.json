{"ast":null,"code":"\"use strict\";\n/* eslint-disable no-new-func */\n\nconst acorn = require(\"acorn\");\n\nconst findGlobals = require(\"acorn-globals\");\n\nconst escodegen = require(\"escodegen\");\n\nconst jsGlobals = require(\"./browser/js-globals.json\"); // We can't use the default browserify vm shim because it doesn't work in a web worker.\n// \"eval\" is skipped because it's set to a function that calls `runInContext`:\n\n\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(_ref => {\n  let [name] = _ref;\n  return name !== \"eval\" && name in global;\n});\n\nexports.createContext = function (sandbox) {\n  // TODO: This should probably use a symbol\n  Object.defineProperty(sandbox, \"__isVMShimContext\", {\n    value: true,\n    writable: true,\n    configurable: true,\n    enumerable: false\n  });\n\n  for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n    const propDesc = { ...globalPropDesc,\n      value: global[globalName]\n    };\n    Object.defineProperty(sandbox, globalName, propDesc);\n  }\n\n  Object.defineProperty(sandbox, \"eval\", {\n    value(code) {\n      return exports.runInContext(code, sandbox);\n    },\n\n    writable: true,\n    configurable: true,\n    enumerable: false\n  });\n};\n\nexports.isContext = function (sandbox) {\n  return sandbox.__isVMShimContext;\n};\n\nexports.runInContext = function (code, contextifiedSandbox, options) {\n  if (code === \"this\") {\n    // Special case for during window creation.\n    return contextifiedSandbox;\n  }\n\n  if (options === undefined) {\n    options = {};\n  }\n\n  const comments = [];\n  const tokens = [];\n  const ast = acorn.parse(code, {\n    allowReturnOutsideFunction: true,\n    ranges: true,\n    // collect comments in Esprima's format\n    onComment: comments,\n    // collect token ranges\n    onToken: tokens\n  }); // make sure we keep comments\n\n  escodegen.attachComments(ast, comments, tokens);\n  const globals = findGlobals(ast);\n\n  for (let i = 0; i < globals.length; ++i) {\n    if (globals[i].name === \"window\" || globals[i].name === \"this\") {\n      continue;\n    }\n\n    const {\n      nodes\n    } = globals[i];\n\n    for (let j = 0; j < nodes.length; ++j) {\n      const {\n        type,\n        name\n      } = nodes[j];\n      nodes[j].type = \"MemberExpression\";\n      nodes[j].property = {\n        name,\n        type\n      };\n      nodes[j].computed = false;\n      nodes[j].object = {\n        name: \"window\",\n        type: \"Identifier\"\n      };\n    }\n  }\n\n  const lastNode = ast.body[ast.body.length - 1];\n\n  if (lastNode.type === \"ExpressionStatement\") {\n    lastNode.type = \"ReturnStatement\";\n    lastNode.argument = lastNode.expression;\n    delete lastNode.expression;\n  }\n\n  const rewrittenCode = escodegen.generate(ast, {\n    comment: true\n  });\n  const suffix = options.filename !== undefined ? \"\\n//# sourceURL=\" + options.filename : \"\";\n  return Function(\"window\", rewrittenCode + suffix).bind(contextifiedSandbox)(contextifiedSandbox);\n};\n\nexports.Script = class VMShimScript {\n  constructor(code, options) {\n    this._code = code;\n    this._options = options;\n  }\n\n  runInContext(sandbox, options) {\n    return exports.runInContext(this._code, sandbox, { ...this._options,\n      ...options\n    });\n  }\n\n};","map":{"version":3,"names":["acorn","require","findGlobals","escodegen","jsGlobals","jsGlobalEntriesToInstall","Object","entries","filter","name","global","exports","createContext","sandbox","defineProperty","value","writable","configurable","enumerable","globalName","globalPropDesc","propDesc","code","runInContext","isContext","__isVMShimContext","contextifiedSandbox","options","undefined","comments","tokens","ast","parse","allowReturnOutsideFunction","ranges","onComment","onToken","attachComments","globals","i","length","nodes","j","type","property","computed","object","lastNode","body","argument","expression","rewrittenCode","generate","comment","suffix","filename","Function","bind","Script","VMShimScript","constructor","_code","_options"],"sources":["C:/Users/17033/balmco/node_modules/jsdom/lib/jsdom/vm-shim.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-new-func */\nconst acorn = require(\"acorn\");\nconst findGlobals = require(\"acorn-globals\");\nconst escodegen = require(\"escodegen\");\nconst jsGlobals = require(\"./browser/js-globals.json\");\n\n// We can't use the default browserify vm shim because it doesn't work in a web worker.\n\n// \"eval\" is skipped because it's set to a function that calls `runInContext`:\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name !== \"eval\" && name in global);\n\nexports.createContext = function (sandbox) {\n  // TODO: This should probably use a symbol\n  Object.defineProperty(sandbox, \"__isVMShimContext\", {\n    value: true,\n    writable: true,\n    configurable: true,\n    enumerable: false\n  });\n\n  for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n    const propDesc = { ...globalPropDesc, value: global[globalName] };\n    Object.defineProperty(sandbox, globalName, propDesc);\n  }\n\n  Object.defineProperty(sandbox, \"eval\", {\n    value(code) {\n      return exports.runInContext(code, sandbox);\n    },\n    writable: true,\n    configurable: true,\n    enumerable: false\n  });\n};\n\nexports.isContext = function (sandbox) {\n  return sandbox.__isVMShimContext;\n};\n\nexports.runInContext = function (code, contextifiedSandbox, options) {\n  if (code === \"this\") {\n    // Special case for during window creation.\n    return contextifiedSandbox;\n  }\n\n  if (options === undefined) {\n    options = {};\n  }\n\n  const comments = [];\n  const tokens = [];\n  const ast = acorn.parse(code, {\n    allowReturnOutsideFunction: true,\n    ranges: true,\n    // collect comments in Esprima's format\n    onComment: comments,\n    // collect token ranges\n    onToken: tokens\n  });\n\n  // make sure we keep comments\n  escodegen.attachComments(ast, comments, tokens);\n\n  const globals = findGlobals(ast);\n  for (let i = 0; i < globals.length; ++i) {\n    if (globals[i].name === \"window\" || globals[i].name === \"this\") {\n      continue;\n    }\n\n    const { nodes } = globals[i];\n    for (let j = 0; j < nodes.length; ++j) {\n      const { type, name } = nodes[j];\n      nodes[j].type = \"MemberExpression\";\n      nodes[j].property = { name, type };\n      nodes[j].computed = false;\n      nodes[j].object = {\n        name: \"window\",\n        type: \"Identifier\"\n      };\n    }\n  }\n\n  const lastNode = ast.body[ast.body.length - 1];\n  if (lastNode.type === \"ExpressionStatement\") {\n    lastNode.type = \"ReturnStatement\";\n    lastNode.argument = lastNode.expression;\n    delete lastNode.expression;\n  }\n\n  const rewrittenCode = escodegen.generate(ast, { comment: true });\n  const suffix = options.filename !== undefined ? \"\\n//# sourceURL=\" + options.filename : \"\";\n\n  return Function(\"window\", rewrittenCode + suffix).bind(contextifiedSandbox)(contextifiedSandbox);\n};\n\nexports.Script = class VMShimScript {\n  constructor(code, options) {\n    this._code = code;\n    this._options = options;\n  }\n\n  runInContext(sandbox, options) {\n    return exports.runInContext(this._code, sandbox, { ...this._options, ...options });\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}